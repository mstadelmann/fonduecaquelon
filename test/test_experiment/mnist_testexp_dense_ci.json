{
    "globals": {
        "project": "Testexperiment MNIST classifier",
        "author": "Marc",
        "set_random_seed": 33
    },
    "transforms": {
        "resize_norm_inp": [
            "ToTensor",
            {
                "NORM": {
                    "mean": 0.1307,
                    "stdev": 0.3081
                }
            }
        ]
    },
    "data": {
        "MNIST": {
            "processor": "experiment_templates/mnist/mnist_preparator.py",
            "args": {
                "base_path": "test/test_data",
                "subset_train": 0.1,
                "subset_test": 0.1,
                "val_ratio": 0.2,
                "pin_memory": true,
                "num_workers": 4,
                "train_batch_size": 16,
                "val_batch_size": 16,
                "test_batch_size": 1,
                "shuffle_train": true,
                "shuffle_val": false,
                "shuffle_test": false
            }
        }
    },
    "store": {
        "results_path": "test/test_data/results",
        "img_exp_nb": 4,
        "save_last_model": true,
        "save_best_val_model": true,
        "save_best_train_model": true,
        "checkpoint_frequency": 2
    },
    "models": {
        "simpleNet": {
            "path": "src/networks/simpleNet.py",
            "class_name": "simpleNet",
            "args": {
                "nb_in_channels": 1,
                "nb_out_channels": 10,
                "input_shape": [
                    28,
                    28
                ]
            },
            "optimizer": {
                "class_name": "torch.optim.Adam",
                "args": {
                    "lr": 0.001
                }
            },
            "lr_scheduler": {
                "class_name": "torch.optim.lr_scheduler.StepLR",
                "args": {
                    "step_size": 2,
                    "gamma": 0.95
                }
            }
        }
    },
    "train": {
        "path": "experiment_templates/mnist/train_mnist.py",
        "args": {
            "epochs": 2,
            "use_GPU": false,
            "use_AMP": false,
            "accumulate_grad_batches": 1,
            "early_stop_val_loss": 5,
            "early_stop_train_loss": 5,
            "early_stop_nan": 5
        }
    },
    "losses": {
        "cross_ent": {
            "class_name": "torch.nn.CrossEntropyLoss",
            "args": {
                "reduction": "mean"
            }
        }
    },
    "test": {
        "processor": "experiment_templates/mnist/mnist_test.py",
        "test_model": "best",
        "args": {
            "metrics": {
                "nb_test_samples": "100"
            }
        }
    },
    "slurm_cluster": {
        "scratch_results_path": "/tmp/fdq_results/",
        "scratch_data_path": "/tmp/fdq_data/"
    }
}