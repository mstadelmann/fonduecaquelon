{
    "globals": {
        "project": "Segment OXPET classifier",
        "author": "Marc"
    },
    "data": {
        "OXPET": {
            "processor": "~/dev/fonduecaquelon/experiment_templates/segment_pets/oxfordpet_preparator.py",
            "args": {
                "base_path": "~/data/ML_data/oxford_pets/",
                "subset_train": 0.2,
                "subset_val": 0.2,
                "subset_test": 0.2,
                "pin_memory": true,
                "num_workers": 4,
                "train_batch_size": 32,
                "val_batch_size": 32,
                "test_batch_size": 1,
                "shuffle_train": true,
                "shuffle_val": false,
                "shuffle_test": false,
                "max_img_size": 256
            }
        }
    },
    "models": {
        "ccUNET": {
            "module_name": "chuchichaestli.models.unet.unet",
            "class_name": "UNet",
            "args": {
                "dimensions": 2,
                "in_channels": 3,
                "out_channels": 1,
                "down_block_types": [
                    "DownBlock",
                    "DownBlock"
                ],
                "up_block_types": [
                    "UpBlock",
                    "UpBlock"
                ],
                "block_out_channel_mults": [
                    1,
                    2
                ],
                "time_embedding": false
            },
            "optimizer": {
                "name": "adam",
                "lr": 0.001
            },
            "lr_scheduler": {
                "name": "step_lr",
                "step_size": 2,
                "gamma": 0.95
            }
        }
    },
    "train": {
        "train_loop": "~/dev/fonduecaquelon/experiment_templates/segment_pets/train.py",
        "args": {
            "epochs": 8,
            "use_GPU": false,
            "use_AMP": false,
            "accumulate_grad_batches": 1,
            "early_stop_val_loss": 5,
            "early_stop_train_loss": 5,
            "early_stop_nan": 5
        }
    },
    "losses": {
        "cp": {
            "name": "crossentropy",
            "reduction": "mean"
        }
    },
    "store": {
        "results_path": "~/data/ML_data/results",
        "cluster_results_path": "/scratch/fdq_results",
        "img_exp_nb": 4,
        "save_last_model": true,
        "save_best_val_model": true,
        "save_best_train_model": true,
        "checkpoint_frequency": 2
    },
    "test": {
        "evaluator": "~/dev/fonduecaquelon/experiment_templates/mnist/mnist_test.py",
        "test_model": "best",
        "args": {
            "metrics": {
                "nb_test_samples": "100"
            }
        }
    }
}